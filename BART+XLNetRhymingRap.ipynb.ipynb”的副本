{"nbformat":4,"nbformat_minor":0,"metadata":{"accelerator":"GPU","colab":{"name":"BART+XLNetRhymingRap.ipynb","provenance":[{"file_id":"1oXorLMoGDDlyBzgh1TyS9XjCO1LBvcfN","timestamp":1615175890860},{"file_id":"1LNxcgMhVbdkU_Min4QrMOTbFMzbx2xId","timestamp":1614728033216}],"collapsed_sections":[],"toc_visible":true},"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.8.5"},"widgets":{"application/vnd.jupyter.widget-state+json":{"d592825b15fc483799777e9640561342":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_0a14fb75ccfb433dabdd5cfcfdf356d6","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_d31b6185c683490d90acb9112dc7dcdf","IPY_MODEL_3e057fc7b3d1452082f3141bec06b949"]}},"0a14fb75ccfb433dabdd5cfcfdf356d6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"d31b6185c683490d90acb9112dc7dcdf":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_edc7ab26ce3849c6835d2755cb9b5d88","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":898823,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":898823,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_750fa19b1cde4d349342884f7a0ab437"}},"3e057fc7b3d1452082f3141bec06b949":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_8ecb6f03a2084ddbbf6ab01453bd327e","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 899k/899k [00:38&lt;00:00, 23.2kB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_ce863cce301c4a34b42670a59a5b2fb0"}},"edc7ab26ce3849c6835d2755cb9b5d88":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"750fa19b1cde4d349342884f7a0ab437":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"8ecb6f03a2084ddbbf6ab01453bd327e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"ce863cce301c4a34b42670a59a5b2fb0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"ed23833b3e174bd28b0eb124801d5540":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_7df25cec99b344b6a86b29ee9ed6abb3","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_d837fbb7c8874c3b8822c181ac9fcdd9","IPY_MODEL_5bfa1bae08ea47c9b29efa39ee28c1a4"]}},"7df25cec99b344b6a86b29ee9ed6abb3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"d837fbb7c8874c3b8822c181ac9fcdd9":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_85647a95e6314c9fa1e67ade74dc3cae","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":456318,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":456318,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_d53b4fbd1abe422b872676e5f075e38c"}},"5bfa1bae08ea47c9b29efa39ee28c1a4":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_17bda82660f248aabc5b0da883fd2ccd","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 456k/456k [00:00&lt;00:00, 1.25MB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_ca6d159d6e2f4188ba9e58ad1cb9744f"}},"85647a95e6314c9fa1e67ade74dc3cae":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"d53b4fbd1abe422b872676e5f075e38c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"17bda82660f248aabc5b0da883fd2ccd":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"ca6d159d6e2f4188ba9e58ad1cb9744f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"ad30f6cddafa4b44b754cb74b0260a89":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_d0e4fdaa10524801a7e00a74d8502e74","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_0dad18ae88844721ba843b823c717e43","IPY_MODEL_d3185a9c7b644b47a803dff8a8b09136"]}},"d0e4fdaa10524801a7e00a74d8502e74":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"0dad18ae88844721ba843b823c717e43":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_6bbae1f05ba9492498eafa825a90637f","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":1553,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1553,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_cc3d8691bdef4162a062bf9c29689069"}},"d3185a9c7b644b47a803dff8a8b09136":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_f8731844d1184a58bb64b81781f04408","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1.55k/1.55k [00:37&lt;00:00, 41.8B/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_65a22bc6a3a44b30b491175c603a47f5"}},"6bbae1f05ba9492498eafa825a90637f":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"cc3d8691bdef4162a062bf9c29689069":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"f8731844d1184a58bb64b81781f04408":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"65a22bc6a3a44b30b491175c603a47f5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"e9a3acef339a4283a275121d673b2f0d":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_13a9e2e4a8ca4265bc8d9a771e669984","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_8b6b3eb434c5457296f5066b925f5449","IPY_MODEL_6d8f0d6e070e47238e307c0b4ca7351b"]}},"13a9e2e4a8ca4265bc8d9a771e669984":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"8b6b3eb434c5457296f5066b925f5449":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_6e028652a62b4efe95ea1f5d21af724a","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":557941479,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":557941479,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_9b9603c2d17c401c8c10edca92d42c44"}},"6d8f0d6e070e47238e307c0b4ca7351b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_ca5af76d98ff47fb8dec255b8989ce76","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 558M/558M [00:10&lt;00:00, 53.1MB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_08f089178cce429fa6a1740755dde6cc"}},"6e028652a62b4efe95ea1f5d21af724a":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"9b9603c2d17c401c8c10edca92d42c44":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"ca5af76d98ff47fb8dec255b8989ce76":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"08f089178cce429fa6a1740755dde6cc":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"bc0265af283943c486d90a7a8e376db0":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_b06498929d914d6792925bcd9fb142d3","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_a2494bff23334851a9b48c66ae2a262a","IPY_MODEL_05fb20c98e7844d6a42bc2745fcf2101"]}},"b06498929d914d6792925bcd9fb142d3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":"row wrap","width":"100%","min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":"inline-flex","left":null}},"a2494bff23334851a9b48c66ae2a262a":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_a341785da2b54f879f698ef947963cf3","_dom_classes":[],"description":"Validation sanity check:   0%","_model_name":"FloatProgressModel","bar_style":"danger","max":2,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":0,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_b8e17c0af4934760a07b9c4f4baeece3"}},"05fb20c98e7844d6a42bc2745fcf2101":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_468d6c6af4fd41139d8fdb0769e3de8d","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 0/2 [28:55&lt;?, ?it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_a12d8ea3bf3a45f6a8bb3a2eda0eb199"}},"a341785da2b54f879f698ef947963cf3":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"b8e17c0af4934760a07b9c4f4baeece3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":"2","_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"468d6c6af4fd41139d8fdb0769e3de8d":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"a12d8ea3bf3a45f6a8bb3a2eda0eb199":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"ecd11e74e10841d590fa052eaf1fd857":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_73bebdbbd614423bb3fb6e1dca9fedfa","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_9356376bbbd6452d8fdbd471ea1ded4c","IPY_MODEL_82521f0217024faaab5054760efd61dc"]}},"73bebdbbd614423bb3fb6e1dca9fedfa":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":"row wrap","width":"100%","min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":"inline-flex","left":null}},"9356376bbbd6452d8fdbd471ea1ded4c":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_d3dca6072c2748de95f117041b3ef551","_dom_classes":[],"description":"Epoch 1: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":7000,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":7000,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_23b0b8936095495ea2bc2cf0facce8bb"}},"82521f0217024faaab5054760efd61dc":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_bedf63d72da144fe919afdc8d15964f7","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 7000/7000 [11:23&lt;00:00, 10.24it/s, loss=3.89, v_num=0]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_567020cdf1e44650b419f71731842709"}},"d3dca6072c2748de95f117041b3ef551":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"23b0b8936095495ea2bc2cf0facce8bb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":"2","_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"bedf63d72da144fe919afdc8d15964f7":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"567020cdf1e44650b419f71731842709":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"0f0ee35123fa4f6691c98450d2dfea43":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_44a9dc4c83f8451786cc9267928a4a5d","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_643e61b964fb48c58a5eab2917c22c01","IPY_MODEL_330519e375f84b439d19a8eeac3b4f1d"]}},"44a9dc4c83f8451786cc9267928a4a5d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":"row wrap","width":"100%","min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":"inline-flex","left":null}},"643e61b964fb48c58a5eab2917c22c01":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_435f7483183a43489e880cbe6618415f","_dom_classes":[],"description":"Validating: 100%","_model_name":"FloatProgressModel","bar_style":"info","max":1750,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1750,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_700ff8c74d9a4c9982d861aac4c30850"}},"330519e375f84b439d19a8eeac3b4f1d":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_1daf792754c5488d9b9d55473b5f8072","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1750/1750 [00:51&lt;00:00, 33.91it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_ae882da9d51b46a78d545e242da7555a"}},"435f7483183a43489e880cbe6618415f":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"700ff8c74d9a4c9982d861aac4c30850":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":"2","_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"1daf792754c5488d9b9d55473b5f8072":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"ae882da9d51b46a78d545e242da7555a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"50842e89a2514f218ec9a80cc4e62e7c":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_ee27c223fbf84dafbcf51e5a29bb6549","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_ffa457a8bb604fa085fb2b8bbe77c725","IPY_MODEL_d60948a029724afd8932fc001af01fa7"]}},"ee27c223fbf84dafbcf51e5a29bb6549":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":"row wrap","width":"100%","min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":"inline-flex","left":null}},"ffa457a8bb604fa085fb2b8bbe77c725":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_99346fb23aac4a3286a2a608192a9434","_dom_classes":[],"description":"Validating: 100%","_model_name":"FloatProgressModel","bar_style":"info","max":1750,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1750,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_ee860aa0a27848beb5afff2f6daac6c4"}},"d60948a029724afd8932fc001af01fa7":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_fda2903138fa4f2bbf38427bb47fe59c","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1750/1750 [00:51&lt;00:00, 33.86it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_a4d891fa504a476bbeba76a67c876309"}},"99346fb23aac4a3286a2a608192a9434":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"ee860aa0a27848beb5afff2f6daac6c4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":"2","_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"fda2903138fa4f2bbf38427bb47fe59c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"a4d891fa504a476bbeba76a67c876309":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"4cd2fdb03e4940d1aadecb6af367564b":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_bc58df088876430096f287f4bf1721e8","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_0156ea1cd13f418185c5345ba1e061fa","IPY_MODEL_db8216653efc4a2699b64a70218cc254"]}},"bc58df088876430096f287f4bf1721e8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"0156ea1cd13f418185c5345ba1e061fa":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_3156d61ae2b348a88236c358827abf54","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":760,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":760,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_e12ca1acb4a645c2b9563f30cb83d042"}},"db8216653efc4a2699b64a70218cc254":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_83f63d32e3854337a893e2550077b84c","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 760/760 [00:02&lt;00:00, 363B/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_d4931215866c4696a8a29742a525a1e1"}},"3156d61ae2b348a88236c358827abf54":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"e12ca1acb4a645c2b9563f30cb83d042":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"83f63d32e3854337a893e2550077b84c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"d4931215866c4696a8a29742a525a1e1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"e801b6a86ad04707a1886b5433668f9b":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_04c8a5fe30dc4497b06387b56629a7c1","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_907ebd37c9f2442a80348b5e0bfab861","IPY_MODEL_81b385f43e5f4d20863b270492c6309e"]}},"04c8a5fe30dc4497b06387b56629a7c1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"907ebd37c9f2442a80348b5e0bfab861":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_5ebc42a8cab94d89924f781153f0be8a","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":798011,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":798011,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_118de5e6de64484ca03f62281315fb8d"}},"81b385f43e5f4d20863b270492c6309e":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_017b52004b75404baa3c837494cf35c8","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 798k/798k [00:01&lt;00:00, 629kB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_5829f11642874c4d8a41cb52a3448d1d"}},"5ebc42a8cab94d89924f781153f0be8a":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"118de5e6de64484ca03f62281315fb8d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"017b52004b75404baa3c837494cf35c8":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"5829f11642874c4d8a41cb52a3448d1d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"13cf141c18e843c2bc3057d511fb4c58":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_4feae40dcbfe4a58aa3ec0adb4e7290a","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_feb8cb219ac84c059c50e48d74d3f1fd","IPY_MODEL_4139f314ad5a4ca8b0b422815e9e5dce"]}},"4feae40dcbfe4a58aa3ec0adb4e7290a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"feb8cb219ac84c059c50e48d74d3f1fd":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_11aea9583fc645e592198a923417b6b8","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":1382015,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1382015,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_91e7cbfb8a8c4b14bee0c3cff15d0daf"}},"4139f314ad5a4ca8b0b422815e9e5dce":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_82f470c3a81f4a8d93bad4cb89d2f4f2","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1.38M/1.38M [00:00&lt;00:00, 2.75MB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_52c448f4a7ee46d299d143cef0273713"}},"11aea9583fc645e592198a923417b6b8":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"91e7cbfb8a8c4b14bee0c3cff15d0daf":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"82f470c3a81f4a8d93bad4cb89d2f4f2":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"52c448f4a7ee46d299d143cef0273713":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"208611bb900c42379cec876edad66609":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_dbd359fe3e514422a961f43ea3e5a9a9","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_ae3731d5b7374b73ba93e7ed406a3fbf","IPY_MODEL_13c190cec2ec4ed699be550874522d57"]}},"dbd359fe3e514422a961f43ea3e5a9a9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"ae3731d5b7374b73ba93e7ed406a3fbf":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_1cf2292c4f9c4cf0b669e831395f6a15","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":467042463,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":467042463,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_29270afe1ef049cd8c42f7c78a74127e"}},"13c190cec2ec4ed699be550874522d57":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_3e1fb605a0184330816fdc290f90fe46","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 467M/467M [00:08&lt;00:00, 56.6MB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_682f178e87fd43129d987e7120c8117e"}},"1cf2292c4f9c4cf0b669e831395f6a15":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"29270afe1ef049cd8c42f7c78a74127e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"3e1fb605a0184330816fdc290f90fe46":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"682f178e87fd43129d987e7120c8117e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}}}}},"cells":[{"cell_type":"markdown","metadata":{"id":"KHAjt_gmPE-1"},"source":["##Setup\r\n","\r\n"]},{"cell_type":"code","metadata":{"id":"B7EVTfMVdv4Z","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1615186376410,"user_tz":480,"elapsed":16654,"user":{"displayName":"sm P","photoUrl":"","userId":"09365976717144143194"}},"outputId":"34444e0d-e9b2-441c-ab90-b57b3504a335"},"source":["!pip install -q pytorch-lightning\n","!pip install -q transformers"],"execution_count":null,"outputs":[{"output_type":"stream","text":["\u001b[K     |████████████████████████████████| 819kB 8.2MB/s \n","\u001b[K     |████████████████████████████████| 112kB 45.2MB/s \n","\u001b[K     |████████████████████████████████| 829kB 37.1MB/s \n","\u001b[K     |████████████████████████████████| 276kB 52.2MB/s \n","\u001b[K     |████████████████████████████████| 1.3MB 22.3MB/s \n","\u001b[K     |████████████████████████████████| 296kB 59.3MB/s \n","\u001b[K     |████████████████████████████████| 143kB 58.3MB/s \n","\u001b[?25h  Building wheel for future (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Building wheel for PyYAML (setup.py) ... \u001b[?25l\u001b[?25hdone\n","\u001b[K     |████████████████████████████████| 1.9MB 9.9MB/s \n","\u001b[K     |████████████████████████████████| 890kB 52.3MB/s \n","\u001b[K     |████████████████████████████████| 3.2MB 27.9MB/s \n","\u001b[?25h  Building wheel for sacremoses (setup.py) ... \u001b[?25l\u001b[?25hdone\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"3fDnjiDoeZbK"},"source":["import transformers\n","from torch.utils.data import DataLoader, TensorDataset, random_split, RandomSampler, Dataset\n","import pandas as pd\n","import numpy as np\n","\n","import torch.nn.functional as F\n","import pytorch_lightning as pl\n","import torch\n","from pytorch_lightning.callbacks import ModelCheckpoint\n","\n","from transformers import AutoModelWithLMHead, AutoTokenizer\n","from torch.utils.data import TensorDataset, DataLoader, RandomSampler, SequentialSampler\n","from keras.preprocessing.sequence import pad_sequences\n","from sklearn.model_selection import train_test_split\n","\n","import math\n","import random\n","import re\n","import argparse\n","from tqdm import tqdm, trange\n","import io"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"resources":{"http://localhost:8080/nbextensions/google.colab/files.js":{"data":"Ly8gQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQwovLwovLyBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKLy8geW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgovLyBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKLy8KLy8gICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKLy8KLy8gVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQovLyBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAovLyBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KLy8gU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAovLyBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCi8qKgogKiBAZmlsZW92ZXJ2aWV3IEhlbHBlcnMgZm9yIGdvb2dsZS5jb2xhYiBQeXRob24gbW9kdWxlLgogKi8KKGZ1bmN0aW9uKHNjb3BlKSB7CmZ1bmN0aW9uIHNwYW4odGV4dCwgc3R5bGVBdHRyaWJ1dGVzID0ge30pIHsKICBjb25zdCBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpOwogIGVsZW1lbnQudGV4dENvbnRlbnQgPSB0ZXh0OwogIGZvciAoY29uc3Qga2V5IG9mIE9iamVjdC5rZXlzKHN0eWxlQXR0cmlidXRlcykpIHsKICAgIGVsZW1lbnQuc3R5bGVba2V5XSA9IHN0eWxlQXR0cmlidXRlc1trZXldOwogIH0KICByZXR1cm4gZWxlbWVudDsKfQoKLy8gTWF4IG51bWJlciBvZiBieXRlcyB3aGljaCB3aWxsIGJlIHVwbG9hZGVkIGF0IGEgdGltZS4KY29uc3QgTUFYX1BBWUxPQURfU0laRSA9IDEwMCAqIDEwMjQ7CgpmdW5jdGlvbiBfdXBsb2FkRmlsZXMoaW5wdXRJZCwgb3V0cHV0SWQpIHsKICBjb25zdCBzdGVwcyA9IHVwbG9hZEZpbGVzU3RlcChpbnB1dElkLCBvdXRwdXRJZCk7CiAgY29uc3Qgb3V0cHV0RWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG91dHB1dElkKTsKICAvLyBDYWNoZSBzdGVwcyBvbiB0aGUgb3V0cHV0RWxlbWVudCB0byBtYWtlIGl0IGF2YWlsYWJsZSBmb3IgdGhlIG5leHQgY2FsbAogIC8vIHRvIHVwbG9hZEZpbGVzQ29udGludWUgZnJvbSBQeXRob24uCiAgb3V0cHV0RWxlbWVudC5zdGVwcyA9IHN0ZXBzOwoKICByZXR1cm4gX3VwbG9hZEZpbGVzQ29udGludWUob3V0cHV0SWQpOwp9CgovLyBUaGlzIGlzIHJvdWdobHkgYW4gYXN5bmMgZ2VuZXJhdG9yIChub3Qgc3VwcG9ydGVkIGluIHRoZSBicm93c2VyIHlldCksCi8vIHdoZXJlIHRoZXJlIGFyZSBtdWx0aXBsZSBhc3luY2hyb25vdXMgc3RlcHMgYW5kIHRoZSBQeXRob24gc2lkZSBpcyBnb2luZwovLyB0byBwb2xsIGZvciBjb21wbGV0aW9uIG9mIGVhY2ggc3RlcC4KLy8gVGhpcyB1c2VzIGEgUHJvbWlzZSB0byBibG9jayB0aGUgcHl0aG9uIHNpZGUgb24gY29tcGxldGlvbiBvZiBlYWNoIHN0ZXAsCi8vIHRoZW4gcGFzc2VzIHRoZSByZXN1bHQgb2YgdGhlIHByZXZpb3VzIHN0ZXAgYXMgdGhlIGlucHV0IHRvIHRoZSBuZXh0IHN0ZXAuCmZ1bmN0aW9uIF91cGxvYWRGaWxlc0NvbnRpbnVlKG91dHB1dElkKSB7CiAgY29uc3Qgb3V0cHV0RWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG91dHB1dElkKTsKICBjb25zdCBzdGVwcyA9IG91dHB1dEVsZW1lbnQuc3RlcHM7CgogIGNvbnN0IG5leHQgPSBzdGVwcy5uZXh0KG91dHB1dEVsZW1lbnQubGFzdFByb21pc2VWYWx1ZSk7CiAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShuZXh0LnZhbHVlLnByb21pc2UpLnRoZW4oKHZhbHVlKSA9PiB7CiAgICAvLyBDYWNoZSB0aGUgbGFzdCBwcm9taXNlIHZhbHVlIHRvIG1ha2UgaXQgYXZhaWxhYmxlIHRvIHRoZSBuZXh0CiAgICAvLyBzdGVwIG9mIHRoZSBnZW5lcmF0b3IuCiAgICBvdXRwdXRFbGVtZW50Lmxhc3RQcm9taXNlVmFsdWUgPSB2YWx1ZTsKICAgIHJldHVybiBuZXh0LnZhbHVlLnJlc3BvbnNlOwogIH0pOwp9CgovKioKICogR2VuZXJhdG9yIGZ1bmN0aW9uIHdoaWNoIGlzIGNhbGxlZCBiZXR3ZWVuIGVhY2ggYXN5bmMgc3RlcCBvZiB0aGUgdXBsb2FkCiAqIHByb2Nlc3MuCiAqIEBwYXJhbSB7c3RyaW5nfSBpbnB1dElkIEVsZW1lbnQgSUQgb2YgdGhlIGlucHV0IGZpbGUgcGlja2VyIGVsZW1lbnQuCiAqIEBwYXJhbSB7c3RyaW5nfSBvdXRwdXRJZCBFbGVtZW50IElEIG9mIHRoZSBvdXRwdXQgZGlzcGxheS4KICogQHJldHVybiB7IUl0ZXJhYmxlPCFPYmplY3Q+fSBJdGVyYWJsZSBvZiBuZXh0IHN0ZXBzLgogKi8KZnVuY3Rpb24qIHVwbG9hZEZpbGVzU3RlcChpbnB1dElkLCBvdXRwdXRJZCkgewogIGNvbnN0IGlucHV0RWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlucHV0SWQpOwogIGlucHV0RWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlOwoKICBjb25zdCBvdXRwdXRFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQob3V0cHV0SWQpOwogIG91dHB1dEVsZW1lbnQuaW5uZXJIVE1MID0gJyc7CgogIGNvbnN0IHBpY2tlZFByb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gewogICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIChlKSA9PiB7CiAgICAgIHJlc29sdmUoZS50YXJnZXQuZmlsZXMpOwogICAgfSk7CiAgfSk7CgogIGNvbnN0IGNhbmNlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpOwogIGlucHV0RWxlbWVudC5wYXJlbnRFbGVtZW50LmFwcGVuZENoaWxkKGNhbmNlbCk7CiAgY2FuY2VsLnRleHRDb250ZW50ID0gJ0NhbmNlbCB1cGxvYWQnOwogIGNvbnN0IGNhbmNlbFByb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gewogICAgY2FuY2VsLm9uY2xpY2sgPSAoKSA9PiB7CiAgICAgIHJlc29sdmUobnVsbCk7CiAgICB9OwogIH0pOwoKICAvLyBXYWl0IGZvciB0aGUgdXNlciB0byBwaWNrIHRoZSBmaWxlcy4KICBjb25zdCBmaWxlcyA9IHlpZWxkIHsKICAgIHByb21pc2U6IFByb21pc2UucmFjZShbcGlja2VkUHJvbWlzZSwgY2FuY2VsUHJvbWlzZV0pLAogICAgcmVzcG9uc2U6IHsKICAgICAgYWN0aW9uOiAnc3RhcnRpbmcnLAogICAgfQogIH07CgogIGNhbmNlbC5yZW1vdmUoKTsKCiAgLy8gRGlzYWJsZSB0aGUgaW5wdXQgZWxlbWVudCBzaW5jZSBmdXJ0aGVyIHBpY2tzIGFyZSBub3QgYWxsb3dlZC4KICBpbnB1dEVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlOwoKICBpZiAoIWZpbGVzKSB7CiAgICByZXR1cm4gewogICAgICByZXNwb25zZTogewogICAgICAgIGFjdGlvbjogJ2NvbXBsZXRlJywKICAgICAgfQogICAgfTsKICB9CgogIGZvciAoY29uc3QgZmlsZSBvZiBmaWxlcykgewogICAgY29uc3QgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpOwogICAgbGkuYXBwZW5kKHNwYW4oZmlsZS5uYW1lLCB7Zm9udFdlaWdodDogJ2JvbGQnfSkpOwogICAgbGkuYXBwZW5kKHNwYW4oCiAgICAgICAgYCgke2ZpbGUudHlwZSB8fCAnbi9hJ30pIC0gJHtmaWxlLnNpemV9IGJ5dGVzLCBgICsKICAgICAgICBgbGFzdCBtb2RpZmllZDogJHsKICAgICAgICAgICAgZmlsZS5sYXN0TW9kaWZpZWREYXRlID8gZmlsZS5sYXN0TW9kaWZpZWREYXRlLnRvTG9jYWxlRGF0ZVN0cmluZygpIDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ24vYSd9IC0gYCkpOwogICAgY29uc3QgcGVyY2VudCA9IHNwYW4oJzAlIGRvbmUnKTsKICAgIGxpLmFwcGVuZENoaWxkKHBlcmNlbnQpOwoKICAgIG91dHB1dEVsZW1lbnQuYXBwZW5kQ2hpbGQobGkpOwoKICAgIGNvbnN0IGZpbGVEYXRhUHJvbWlzZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7CiAgICAgIGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7CiAgICAgIHJlYWRlci5vbmxvYWQgPSAoZSkgPT4gewogICAgICAgIHJlc29sdmUoZS50YXJnZXQucmVzdWx0KTsKICAgICAgfTsKICAgICAgcmVhZGVyLnJlYWRBc0FycmF5QnVmZmVyKGZpbGUpOwogICAgfSk7CiAgICAvLyBXYWl0IGZvciB0aGUgZGF0YSB0byBiZSByZWFkeS4KICAgIGxldCBmaWxlRGF0YSA9IHlpZWxkIHsKICAgICAgcHJvbWlzZTogZmlsZURhdGFQcm9taXNlLAogICAgICByZXNwb25zZTogewogICAgICAgIGFjdGlvbjogJ2NvbnRpbnVlJywKICAgICAgfQogICAgfTsKCiAgICAvLyBVc2UgYSBjaHVua2VkIHNlbmRpbmcgdG8gYXZvaWQgbWVzc2FnZSBzaXplIGxpbWl0cy4gU2VlIGIvNjIxMTU2NjAuCiAgICBsZXQgcG9zaXRpb24gPSAwOwogICAgd2hpbGUgKHBvc2l0aW9uIDwgZmlsZURhdGEuYnl0ZUxlbmd0aCkgewogICAgICBjb25zdCBsZW5ndGggPSBNYXRoLm1pbihmaWxlRGF0YS5ieXRlTGVuZ3RoIC0gcG9zaXRpb24sIE1BWF9QQVlMT0FEX1NJWkUpOwogICAgICBjb25zdCBjaHVuayA9IG5ldyBVaW50OEFycmF5KGZpbGVEYXRhLCBwb3NpdGlvbiwgbGVuZ3RoKTsKICAgICAgcG9zaXRpb24gKz0gbGVuZ3RoOwoKICAgICAgY29uc3QgYmFzZTY0ID0gYnRvYShTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsIGNodW5rKSk7CiAgICAgIHlpZWxkIHsKICAgICAgICByZXNwb25zZTogewogICAgICAgICAgYWN0aW9uOiAnYXBwZW5kJywKICAgICAgICAgIGZpbGU6IGZpbGUubmFtZSwKICAgICAgICAgIGRhdGE6IGJhc2U2NCwKICAgICAgICB9LAogICAgICB9OwogICAgICBwZXJjZW50LnRleHRDb250ZW50ID0KICAgICAgICAgIGAke01hdGgucm91bmQoKHBvc2l0aW9uIC8gZmlsZURhdGEuYnl0ZUxlbmd0aCkgKiAxMDApfSUgZG9uZWA7CiAgICB9CiAgfQoKICAvLyBBbGwgZG9uZS4KICB5aWVsZCB7CiAgICByZXNwb25zZTogewogICAgICBhY3Rpb246ICdjb21wbGV0ZScsCiAgICB9CiAgfTsKfQoKc2NvcGUuZ29vZ2xlID0gc2NvcGUuZ29vZ2xlIHx8IHt9OwpzY29wZS5nb29nbGUuY29sYWIgPSBzY29wZS5nb29nbGUuY29sYWIgfHwge307CnNjb3BlLmdvb2dsZS5jb2xhYi5fZmlsZXMgPSB7CiAgX3VwbG9hZEZpbGVzLAogIF91cGxvYWRGaWxlc0NvbnRpbnVlLAp9Owp9KShzZWxmKTsK","ok":true,"headers":[["content-type","application/javascript"]],"status":200,"status_text":""}},"base_uri":"https://localhost:8080/","height":158},"id":"O48p2-T9J7lb","executionInfo":{"status":"ok","timestamp":1615186504808,"user_tz":480,"elapsed":145042,"user":{"displayName":"sm P","photoUrl":"","userId":"09365976717144143194"}},"outputId":"e1180036-840a-4e25-b54a-c045723a5ebd"},"source":["from google.colab import files\r\n","uploaded = files.upload()\r\n","uploaded1 = files.upload()\r\n","uploaded2 = files.upload()"],"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/html":["\n","     <input type=\"file\" id=\"files-419872fc-3712-4a77-a390-3a1585bf7427\" name=\"files[]\" multiple disabled\n","        style=\"border:none\" />\n","     <output id=\"result-419872fc-3712-4a77-a390-3a1585bf7427\">\n","      Upload widget is only available when the cell has been executed in the\n","      current browser session. Please rerun this cell to enable.\n","      </output>\n","      <script src=\"/nbextensions/google.colab/files.js\"></script> "],"text/plain":["<IPython.core.display.HTML object>"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Saving sciryl.csv to sciryl.csv\n"],"name":"stdout"},{"output_type":"display_data","data":{"text/html":["\n","     <input type=\"file\" id=\"files-74311728-c9fb-4207-913b-402555d35638\" name=\"files[]\" multiple disabled\n","        style=\"border:none\" />\n","     <output id=\"result-74311728-c9fb-4207-913b-402555d35638\">\n","      Upload widget is only available when the cell has been executed in the\n","      current browser session. Please rerun this cell to enable.\n","      </output>\n","      <script src=\"/nbextensions/google.colab/files.js\"></script> "],"text/plain":["<IPython.core.display.HTML object>"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Saving dict.txt to dict.txt\n"],"name":"stdout"},{"output_type":"display_data","data":{"text/html":["\n","     <input type=\"file\" id=\"files-9f3597fa-8210-4f84-8e95-98c93b363c8d\" name=\"files[]\" multiple disabled\n","        style=\"border:none\" />\n","     <output id=\"result-9f3597fa-8210-4f84-8e95-98c93b363c8d\">\n","      Upload widget is only available when the cell has been executed in the\n","      current browser session. Please rerun this cell to enable.\n","      </output>\n","      <script src=\"/nbextensions/google.colab/files.js\"></script> "],"text/plain":["<IPython.core.display.HTML object>"]},"metadata":{"tags":[]}}]},{"cell_type":"markdown","metadata":{"id":"Fbo4w7eMkiRv"},"source":["##BART Part"]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Goj88fbbQ3Wo","executionInfo":{"status":"ok","timestamp":1615186521456,"user_tz":480,"elapsed":161684,"user":{"displayName":"sm P","photoUrl":"","userId":"09365976717144143194"}},"outputId":"5e81ba3e-2208-4c29-b883-7f3fc08f150a"},"source":["from google.colab import drive\n","drive.mount('/content/gdrive', force_remount=False)\n","root_dir = \"/content/gdrive/My Drive/\"\n","base_dir = root_dir + 'BART/'"],"execution_count":null,"outputs":[{"output_type":"stream","text":["Mounted at /content/gdrive\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"cPxWynRmeGlL"},"source":["class LitModel(pl.LightningModule):\n","  # Instantiate the model\n","  def __init__(self, learning_rate, tokenizer, model, hparams):\n","    super().__init__()\n","    self.tokenizer = tokenizer\n","    self.model = model\n","    self.learning_rate = learning_rate\n","    self.hparams = hparams\n","\n","    if self.hparams.freeze_encoder:\n","      freeze_params(self.model.get_encoder())\n","\n","    if self.hparams.freeze_embeds:\n","      self.freeze_embeds()\n","  \n","  def freeze_embeds(self):\n","    ''' freeze the positional embedding parameters of the model; adapted from finetune.py '''\n","    freeze_params(self.model.model.shared)\n","    for d in [self.model.model.encoder, self.model.model.decoder]:\n","      freeze_params(d.embed_positions)\n","      freeze_params(d.embed_tokens)\n","\n","  # Do a forward pass through the model\n","  def forward(self, input_ids, **kwargs):\n","    return self.model(input_ids, **kwargs)\n","  \n","  def configure_optimizers(self):\n","    optimizer = torch.optim.Adam(self.parameters(), lr = self.learning_rate)\n","    return optimizer\n","\n","  def training_step(self, batch, batch_idx):\n","    # Load the data into variables\n","    src_ids, src_mask = batch[0], batch[1]\n","    tgt_ids = batch[2]\n","    # Shift the decoder tokens right (but NOT the tgt_ids)\n","    decoder_input_ids = shift_tokens_right(tgt_ids, tokenizer.pad_token_id)\n","\n","    # Run the model and get the logits\n","    outputs = self(src_ids, attention_mask=src_mask, decoder_input_ids=decoder_input_ids, use_cache=False)\n","    lm_logits = outputs[0]\n","    # Create the loss function\n","    ce_loss_fct = torch.nn.CrossEntropyLoss(ignore_index=self.tokenizer.pad_token_id)\n","    # Calculate the loss on the un-shifted tokens\n","    loss = ce_loss_fct(lm_logits.view(-1, lm_logits.shape[-1]), tgt_ids.view(-1))\n","    return {'loss':loss}\n","\n","  def validation_step(self, batch, batch_idx):\n","\n","    src_ids, src_mask = batch[0], batch[1]\n","    tgt_ids = batch[2]\n","\n","    decoder_input_ids = shift_tokens_right(tgt_ids, tokenizer.pad_token_id)\n","    \n","    # Run the model and get the logits\n","    outputs = self(src_ids, attention_mask=src_mask, decoder_input_ids=decoder_input_ids, use_cache=False)\n","    lm_logits = outputs[0]\n","\n","    ce_loss_fct = torch.nn.CrossEntropyLoss(ignore_index=self.tokenizer.pad_token_id)\n","    val_loss = ce_loss_fct(lm_logits.view(-1, lm_logits.shape[-1]), tgt_ids.view(-1))\n","\n","    return {'loss': val_loss}\n","  \n","  # Method that generates text using the BartForConditionalGeneration's generate() method\n","  def generate_text(self, text, eval_beams, early_stopping = True, max_len = 40, startT = None):\n","    ''' Function to generate text '''\n","    if startT == None:\n","      dstartT = self.tokenizer.pad_token_id\n","    else:\n","      dstartT = tokenizer.convert_tokens_to_ids(startT)\n","    generated_ids = self.model.generate(\n","        text[\"input_ids\"],\n","        attention_mask=text[\"attention_mask\"],\n","        use_cache=True,\n","        decoder_start_token_id = dstartT,\n","        num_beams= eval_beams,\n","        max_length = max_len,\n","        early_stopping = early_stopping\n","    )\n","    return [self.tokenizer.decode(w, skip_special_tokens=True, clean_up_tokenization_spaces=True) for w in generated_ids]\n","\n","def freeze_params(model):\n","  ''' Function that takes a model as input (or part of a model) and freezes the layers for faster training\n","      adapted from finetune.py '''\n","  for layer in model.parameters():\n","    layer.requires_grade = False\n"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"3cUIEJBIjjNJ"},"source":["# Create a dataloading module as per the PyTorch Lightning Docs\n","class SummaryDataModule(pl.LightningDataModule):\n","  def __init__(self, tokenizer, data_file, batch_size, num_examples = 20000):\n","    super().__init__()\n","    self.tokenizer = tokenizer\n","    self.data_file = data_file\n","    self.batch_size = batch_size\n","    self.num_examples = num_examples\n","  \n","  # Loads and splits the data into training, validation and test sets with a 60/20/20 split\n","  def prepare_data(self):\n","    self.data = pd.read_csv(self.data_file)[:self.num_examples]\n","    self.train, self.validate, self.test = np.split(self.data.sample(frac=1), [int(.6*len(self.data)), int(.8*len(self.data))])\n","\n","  # encode the sentences using the tokenizer  \n","  def setup(self, stage):\n","    self.train = encode_sentences(self.tokenizer, self.train['source'], self.train['target'])\n","    self.validate = encode_sentences(self.tokenizer, self.validate['source'], self.validate['target'])\n","    self.test = encode_sentences(self.tokenizer, self.test['source'], self.test['target'])\n","\n","  # Load the training, validation and test sets in Pytorch Dataset objects\n","  def train_dataloader(self):\n","    dataset = TensorDataset(self.train['input_ids'], self.train['attention_mask'], self.train['labels'])                          \n","    train_data = DataLoader(dataset, sampler = RandomSampler(dataset), batch_size = self.batch_size)\n","    return train_data\n","\n","  def val_dataloader(self):\n","    dataset = TensorDataset(self.validate['input_ids'], self.validate['attention_mask'], self.validate['labels']) \n","    val_data = DataLoader(dataset, batch_size = self.batch_size)                       \n","    return val_data\n","\n","  def test_dataloader(self):\n","    dataset = TensorDataset(self.test['input_ids'], self.test['attention_mask'], self.test['labels']) \n","    test_data = DataLoader(dataset, batch_size = self.batch_size)                   \n","    return test_data\n","\n"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"ibsTjaBjZ-OE"},"source":["hparams = argparse.Namespace()\n","\n","hparams.freeze_encoder = True\n","hparams.freeze_embeds = True\n","hparams.eval_beams = 4"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"no6DwOqaE9Jw"},"source":["def shift_tokens_right(input_ids, pad_token_id):\n","  \"\"\" Shift input ids one token to the right, and wrap the last non pad token (usually <eos>).\n","      This is taken directly from modeling_bart.py\n","  \"\"\"\n","  prev_output_tokens = input_ids.clone()\n","  index_of_eos = (input_ids.ne(pad_token_id).sum(dim=1) - 1).unsqueeze(-1)\n","  prev_output_tokens[:, 0] = input_ids.gather(1, index_of_eos).squeeze()\n","  prev_output_tokens[:, 1:] = input_ids[:, :-1]\n","  return prev_output_tokens\n","\n","def encode_sentences(tokenizer, source_sentences, target_sentences, max_length=32, pad_to_max_length=True, return_tensors=\"pt\"):\n","  ''' Function that tokenizes a sentence \n","      Args: tokenizer - the BART tokenizer; source and target sentences are the source and target sentences\n","      Returns: Dictionary with keys: input_ids, attention_mask, target_ids\n","  '''\n","\n","  input_ids = []\n","  attention_masks = []\n","  target_ids = []\n","  tokenized_sentences = {}\n","\n","  for sentence in source_sentences:\n","    encoded_dict = tokenizer(\n","          sentence,\n","          max_length=max_length,\n","          padding=\"max_length\" if pad_to_max_length else None,\n","          truncation=True,\n","          return_tensors=return_tensors,\n","          add_prefix_space = True\n","      )\n","\n","    input_ids.append(encoded_dict['input_ids'])\n","    attention_masks.append(encoded_dict['attention_mask'])\n","\n","  input_ids = torch.cat(input_ids, dim = 0)\n","  attention_masks = torch.cat(attention_masks, dim = 0)\n","\n","  for sentence in target_sentences:\n","    encoded_dict = tokenizer(\n","          sentence,\n","          max_length=max_length,\n","          padding=\"max_length\" if pad_to_max_length else None,\n","          truncation=True,\n","          return_tensors=return_tensors,\n","          add_prefix_space = True\n","      )\n","    # Shift the target ids to the right\n","    # shifted_target_ids = shift_tokens_right(encoded_dict['input_ids'], tokenizer.pad_token_id)\n","    target_ids.append(encoded_dict['input_ids'])\n","\n","  target_ids = torch.cat(target_ids, dim = 0)\n","  \n","\n","  batch = {\n","      \"input_ids\": input_ids,\n","      \"attention_mask\": attention_masks,\n","      \"labels\": target_ids,\n","  }\n","\n","  return batch\n","\n","\n","def noise_sentence(sentence_, percent_words, replacement_token = \"<mask>\"):\n","  '''\n","  Function that noises a sentence by adding <mask> tokens\n","  Args: sentence - the sentence to noise\n","        percent_words - the percent of words to replace with <mask> tokens; the number is rounded up using math.ceil\n","  Returns a noised sentence\n","  '''\n","  # Create a list item and copy\n","  sentence_ = sentence_.split(' ')\n","  sentence = sentence_.copy()\n","  \n","  num_words = math.ceil(len(sentence) * percent_words)\n","  \n","  # Create an array of tokens to sample from; don't include the last word as an option because in the case of lyrics\n","  # that word is often a rhyming word and plays an important role in song construction\n","  sample_tokens = set(np.arange(0, np.maximum(1, len(sentence)-1)))\n","  \n","  words_to_noise = random.sample(sample_tokens, num_words)\n","  \n","  # Swap out words, but not full stops\n","  for pos in words_to_noise:\n","      if sentence[pos] != '.':\n","          sentence[pos] = replacement_token\n","  \n","  # Remove redundant spaces\n","  sentence = re.sub(r' {2,5}', ' ', ' '.join(sentence))\n","  \n","  # Combine concurrent <mask> tokens into a single token; this just does two rounds of this; more could be done\n","  sentence = re.sub(r'<mask> <mask>', \"<mask>\", sentence)\n","  sentence = re.sub(r'<mask> <mask>', \"<mask>\", sentence)\n","  return sentence\n","  "],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"sAKO4lHfiJMP","colab":{"base_uri":"https://localhost:8080/","height":212,"referenced_widgets":["d592825b15fc483799777e9640561342","0a14fb75ccfb433dabdd5cfcfdf356d6","d31b6185c683490d90acb9112dc7dcdf","3e057fc7b3d1452082f3141bec06b949","edc7ab26ce3849c6835d2755cb9b5d88","750fa19b1cde4d349342884f7a0ab437","8ecb6f03a2084ddbbf6ab01453bd327e","ce863cce301c4a34b42670a59a5b2fb0","ed23833b3e174bd28b0eb124801d5540","7df25cec99b344b6a86b29ee9ed6abb3","d837fbb7c8874c3b8822c181ac9fcdd9","5bfa1bae08ea47c9b29efa39ee28c1a4","85647a95e6314c9fa1e67ade74dc3cae","d53b4fbd1abe422b872676e5f075e38c","17bda82660f248aabc5b0da883fd2ccd","ca6d159d6e2f4188ba9e58ad1cb9744f","ad30f6cddafa4b44b754cb74b0260a89","d0e4fdaa10524801a7e00a74d8502e74","0dad18ae88844721ba843b823c717e43","d3185a9c7b644b47a803dff8a8b09136","6bbae1f05ba9492498eafa825a90637f","cc3d8691bdef4162a062bf9c29689069","f8731844d1184a58bb64b81781f04408","65a22bc6a3a44b30b491175c603a47f5","e9a3acef339a4283a275121d673b2f0d","13a9e2e4a8ca4265bc8d9a771e669984","8b6b3eb434c5457296f5066b925f5449","6d8f0d6e070e47238e307c0b4ca7351b","6e028652a62b4efe95ea1f5d21af724a","9b9603c2d17c401c8c10edca92d42c44","ca5af76d98ff47fb8dec255b8989ce76","08f089178cce429fa6a1740755dde6cc"]},"executionInfo":{"status":"ok","timestamp":1615186542331,"user_tz":480,"elapsed":182540,"user":{"displayName":"sm P","photoUrl":"","userId":"09365976717144143194"}},"outputId":"5f9b18b8-5a8c-448f-b967-8971bd074afe"},"source":["# Load the model\n","from transformers import BartTokenizer, BartForConditionalGeneration, AdamW, BartConfig, BartModel\n","\n","tokenizer = BartTokenizer.from_pretrained('facebook/bart-base', add_prefix_space=True)\n","\n","bart_model = BartForConditionalGeneration.from_pretrained(\n","    \"facebook/bart-base\")\n"],"execution_count":null,"outputs":[{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"d592825b15fc483799777e9640561342","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=898823.0, style=ProgressStyle(descripti…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"ed23833b3e174bd28b0eb124801d5540","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=456318.0, style=ProgressStyle(descripti…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"ad30f6cddafa4b44b754cb74b0260a89","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=1553.0, style=ProgressStyle(description…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"e9a3acef339a4283a275121d673b2f0d","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=557941479.0, style=ProgressStyle(descri…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"_h8QhLcyh9RJ"},"source":["# Load the data into the model for training\n","summary_data = SummaryDataModule(tokenizer, '/content/gdrive/My Drive/BART learns to rap/lyrics_simple_noised.csv',\n","                                 batch_size = 16, num_examples = 140000)\n","\n","# Load the model from a pre-saved checkpoint; alternatively use the code below to start training from scratch\n","# model = LitModel.load_from_checkpoint(base_dir + \"checkpoint_files_2/8_ep_140k_simple_0210.ckpt\",\n","#                                       learning_rate = 2e-5, tokenizer = tokenizer, model = bart_model, hparams = hparams)\n","\n","model = LitModel(learning_rate = 2e-5, tokenizer = tokenizer, model = bart_model, hparams = hparams)"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"qAj9wgyRXbRG","executionInfo":{"status":"ok","timestamp":1615186542337,"user_tz":480,"elapsed":182540,"user":{"displayName":"sm P","photoUrl":"","userId":"09365976717144143194"}},"outputId":"a2257c0e-1ce4-4653-979e-51fb31a868f7"},"source":["#checkpoint = ModelCheckpoint(filepath=base_dir + 'checkpoint_files_2/')\n","trainer = pl.Trainer(gpus = 1,\n","                     max_epochs = 2,\n","                     min_epochs = 2,\n","                     auto_lr_find = False,\n","                     \n","                     progress_bar_refresh_rate = 500)"],"execution_count":null,"outputs":[{"output_type":"stream","text":["GPU available: True, used: True\n","TPU available: None, using: 0 TPU cores\n"],"name":"stderr"}]},{"cell_type":"code","metadata":{"id":"iWccEjPWwhHW","colab":{"base_uri":"https://localhost:8080/","height":266,"referenced_widgets":["bc0265af283943c486d90a7a8e376db0","b06498929d914d6792925bcd9fb142d3","a2494bff23334851a9b48c66ae2a262a","05fb20c98e7844d6a42bc2745fcf2101","a341785da2b54f879f698ef947963cf3","b8e17c0af4934760a07b9c4f4baeece3","468d6c6af4fd41139d8fdb0769e3de8d","a12d8ea3bf3a45f6a8bb3a2eda0eb199","ecd11e74e10841d590fa052eaf1fd857","73bebdbbd614423bb3fb6e1dca9fedfa","9356376bbbd6452d8fdbd471ea1ded4c","82521f0217024faaab5054760efd61dc","d3dca6072c2748de95f117041b3ef551","23b0b8936095495ea2bc2cf0facce8bb","bedf63d72da144fe919afdc8d15964f7","567020cdf1e44650b419f71731842709","0f0ee35123fa4f6691c98450d2dfea43","44a9dc4c83f8451786cc9267928a4a5d","643e61b964fb48c58a5eab2917c22c01","330519e375f84b439d19a8eeac3b4f1d","435f7483183a43489e880cbe6618415f","700ff8c74d9a4c9982d861aac4c30850","1daf792754c5488d9b9d55473b5f8072","ae882da9d51b46a78d545e242da7555a","50842e89a2514f218ec9a80cc4e62e7c","ee27c223fbf84dafbcf51e5a29bb6549","ffa457a8bb604fa085fb2b8bbe77c725","d60948a029724afd8932fc001af01fa7","99346fb23aac4a3286a2a608192a9434","ee860aa0a27848beb5afff2f6daac6c4","fda2903138fa4f2bbf38427bb47fe59c","a4d891fa504a476bbeba76a67c876309"]},"executionInfo":{"status":"ok","timestamp":1615188069806,"user_tz":480,"elapsed":1710004,"user":{"displayName":"sm P","photoUrl":"","userId":"09365976717144143194"}},"outputId":"547b2f06-47a2-4144-ec59-b9a72bd35389"},"source":["# Fit the instantiated model to the data\n","trainer.fit(model, summary_data)"],"execution_count":null,"outputs":[{"output_type":"stream","text":["\n","  | Name  | Type                         | Params\n","-------------------------------------------------------\n","0 | model | BartForConditionalGeneration | 139 M \n","-------------------------------------------------------\n","139 M     Trainable params\n","0         Non-trainable params\n","139 M     Total params\n","557.682   Total estimated model params size (MB)\n"],"name":"stderr"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"bc0265af283943c486d90a7a8e376db0","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', description='Validation sanity check', layout=Layout…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\r"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"ecd11e74e10841d590fa052eaf1fd857","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', description='Training', layout=Layout(flex='2'), max…"]},"metadata":{"tags":[]}},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"0f0ee35123fa4f6691c98450d2dfea43","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', description='Validating', layout=Layout(flex='2'), m…"]},"metadata":{"tags":[]}},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"50842e89a2514f218ec9a80cc4e62e7c","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', description='Validating', layout=Layout(flex='2'), m…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"execute_result","data":{"text/plain":["1"]},"metadata":{"tags":[]},"execution_count":12}]},{"cell_type":"code","metadata":{"id":"xj6WYHbFO_9V"},"source":["def generate_lyrics(seed_line, num_lines, model_, startW, noise_percent = 0.25, multiple_lines = False, max_line_history = 3):\n","  ''' Function that generates lyrics based on previously generated lyrics \n","      Args: seed_line - a line to start off the machine\n","            num_lines - the number of lines to generate\n","            model_ - the model used to generate the text\n","            multiple_lines - whether the model generates based on multiple previous lines or just the past line\n","            max_line_history - the maximum number of previous lines used in the current input\n","      Returns a list with num_lines of rap lines\n","  '''\n","  # Put the model on eval mode\n","  model_.to(torch.device('cpu'))\n","  model_.eval()\n","  lyrics = []\n","  lyrics.append(seed_line)\n","  prompt_line_tokens = tokenizer(noise_sentence(seed_line, 0.2), max_length = 32, return_tensors = \"pt\", truncation = True)\n","  # Loop through the number of lines generating a new line based on the old\n","\n","  line = [seed_line]\n","  for i in range(num_lines):\n","    # Print out the new line\n","    print(line[0].strip())\n","    lyrics.append(line[0])\n","    line = model.generate_text(prompt_line_tokens, eval_beams = 4, startT = startW)\n","    # This deals with an artefact in the training data that I had an issue cleaning\n","    if line[0].find(\":\") != -1:\n","      line[0] = re.sub(r'[A-Z]+: ', '', line[0])\n","    # This allows the model to generate a new line conditioned on more than one line\n","    if multiple_lines:\n","      start_line = np.maximum(0, i - max_line_history)\n","      end_line = i\n","      prompt_line = ' '.join(lyrics[start_line:end_line]) # Going to end_line is fine because it is non-inclusive\n","    else:\n","      prompt_line = lyrics[i]\n","    prompt_line_tokens = tokenizer(noise_sentence(prompt_line, noise_percent), max_length = 32, return_tensors = \"pt\", truncation = True)\n","\n","  return lyrics"],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"nwnf7MxBCimQ"},"source":["## XLnet rap generator"]},{"cell_type":"code","metadata":{"id":"18ZZlrn9bvyE"},"source":["device = torch.device(\"cuda\" if torch.cuda.is_available() else \"cpu\")"],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"AWUIq72pCo_G"},"source":["Ingest data\n"]},{"cell_type":"code","metadata":{"id":"VS2XF1G9rlLV","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1615188070499,"user_tz":480,"elapsed":1710683,"user":{"displayName":"sm P","photoUrl":"","userId":"09365976717144143194"}},"outputId":"0deefb9d-9f42-43d0-fefb-bc0227b9780d"},"source":["df = pd.read_csv(\"sciryl.csv\", delimiter='\\t', header=None, names=['sentence_source'], encoding=\"latin-1\")\n","df.shape\n","#df.sample(10)\n","#remove commas from end of lines\n","df2 = df.replace({',':''}, regex=True)\n","df2.size\n","#FOR TESTING\n","test_df = df2.sample(10000)\n","print(test_df)"],"execution_count":null,"outputs":[{"output_type":"stream","text":["                                          sentence_source\n","5478                                  nigga sellout a You\n","125369             \"one become it'd hoping love holla We\"\n","75325   today Piper Peter peppers pickin' like off you...\n","56341            want I what take I'ma you see I when And\n","107979                       on it's yeah time my it's Oh\n","...                                                   ...\n","36989                           \"yeah me on wishin' They\"\n","64518   out brains her fuck always 'cause me love she ...\n","136075                 \"fakes the see I snakes the see I\"\n","63876              Julio like bullets catching he shit Aw\n","2944    \"different a through life me showed up world w...\n","\n","[10000 rows x 1 columns]\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"0YTgzuVVXOPr"},"source":["preprocess data for xl-net\n"]},{"cell_type":"code","metadata":{"id":"q7GDIkcrXREb","colab":{"base_uri":"https://localhost:8080/","referenced_widgets":["4cd2fdb03e4940d1aadecb6af367564b","bc58df088876430096f287f4bf1721e8","0156ea1cd13f418185c5345ba1e061fa","db8216653efc4a2699b64a70218cc254","3156d61ae2b348a88236c358827abf54","e12ca1acb4a645c2b9563f30cb83d042","83f63d32e3854337a893e2550077b84c","d4931215866c4696a8a29742a525a1e1","e801b6a86ad04707a1886b5433668f9b","04c8a5fe30dc4497b06387b56629a7c1","907ebd37c9f2442a80348b5e0bfab861","81b385f43e5f4d20863b270492c6309e","5ebc42a8cab94d89924f781153f0be8a","118de5e6de64484ca03f62281315fb8d","017b52004b75404baa3c837494cf35c8","5829f11642874c4d8a41cb52a3448d1d","13cf141c18e843c2bc3057d511fb4c58","4feae40dcbfe4a58aa3ec0adb4e7290a","feb8cb219ac84c059c50e48d74d3f1fd","4139f314ad5a4ca8b0b422815e9e5dce","11aea9583fc645e592198a923417b6b8","91e7cbfb8a8c4b14bee0c3cff15d0daf","82f470c3a81f4a8d93bad4cb89d2f4f2","52c448f4a7ee46d299d143cef0273713"]},"executionInfo":{"status":"ok","timestamp":1615188074141,"user_tz":480,"elapsed":1714321,"user":{"displayName":"sm P","photoUrl":"","userId":"09365976717144143194"}},"outputId":"dae53441-f58b-4900-dd01-f9e4799db34a"},"source":["sentences = test_df.sentence_source.values\n","#sentences = [sentence + \" [SEP] [CLS]\" for sentence in sentences]\n","sentences = [sentence + \" [SEP]\" for sentence in sentences]\n","sentences[-1] = sentences[-1] + \" [CLS]\"\n","#sentences = [\"[CLS] [SEP] \" + sentence for sentence in sentences]\n","XLtokenizer = AutoTokenizer.from_pretrained(\"xlnet-base-cased\", do_lower_case=True)\n","\n","tokenized_texts = [XLtokenizer.tokenize(sent) for sent in sentences]\n","#test_text = [XLtokenizer(sent, return_tensors=\"pt\", add_special_tokens=True) for sent in sentences]\n","print(\"Tokenize the first sentence:\")\n","print(tokenized_texts[1])\n","MAX_LEN = 64\n","input_ids = [XLtokenizer.convert_tokens_to_ids(x) for x in tokenized_texts]\n","input_ids = pad_sequences(input_ids, maxlen=MAX_LEN, dtype=\"long\", truncating=\"post\", padding=\"post\")\n","\n","# Create attention masks\n","attention_masks = []\n","\n","# Create a mask of 1s for each token followed by 0s for padding\n","for seq in input_ids:\n","  seq_mask = [float(i>0) for i in seq]\n","  attention_masks.append(seq_mask)\n","\n","#train_inputs = torch.tensor(test_text)\n","train_input_ids = torch.tensor(input_ids)\n","train_masks = torch.tensor(attention_masks)\n"],"execution_count":null,"outputs":[{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"4cd2fdb03e4940d1aadecb6af367564b","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=760.0, style=ProgressStyle(description_…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"e801b6a86ad04707a1886b5433668f9b","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=798011.0, style=ProgressStyle(descripti…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"13cf141c18e843c2bc3057d511fb4c58","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=1382015.0, style=ProgressStyle(descript…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n","Tokenize the first sentence:\n","['▁', '\"', 'one', '▁become', '▁it', \"'\", 'd', '▁hoping', '▁love', '▁hol', 'la', '▁We', '\"', '▁[', 'S', 'EP', ']']\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"6fmblgpRaz59"},"source":["batch_size = 32\n","#train_data = TensorDataset(tokenized_texts, train_input_ids, train_masks)\n","train_data = TensorDataset(train_input_ids, train_masks)\n","train_sampler = RandomSampler(train_data)\n","train_dataloader = DataLoader(train_data, sampler=train_sampler, batch_size=batch_size)\n"],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"79xT7Cw4TW8p"},"source":["Train loop"]},{"cell_type":"code","metadata":{"id":"lsD-4l4ad6zu","colab":{"base_uri":"https://localhost:8080/","referenced_widgets":["208611bb900c42379cec876edad66609","dbd359fe3e514422a961f43ea3e5a9a9","ae3731d5b7374b73ba93e7ed406a3fbf","13c190cec2ec4ed699be550874522d57","1cf2292c4f9c4cf0b669e831395f6a15","29270afe1ef049cd8c42f7c78a74127e","3e1fb605a0184330816fdc290f90fe46","682f178e87fd43129d987e7120c8117e"]},"executionInfo":{"status":"ok","timestamp":1615188086765,"user_tz":480,"elapsed":1726938,"user":{"displayName":"sm P","photoUrl":"","userId":"09365976717144143194"}},"outputId":"3f0b2f60-5273-480d-a094-c5bc4f5d2583"},"source":["XLmodel = AutoModelWithLMHead.from_pretrained(\"xlnet-base-cased\", return_dict=True)\n","#XLmodel.cuda()\n"],"execution_count":null,"outputs":[{"output_type":"stream","text":["/usr/local/lib/python3.7/dist-packages/transformers/models/auto/modeling_auto.py:970: FutureWarning: The class `AutoModelWithLMHead` is deprecated and will be removed in a future version. Please use `AutoModelForCausalLM` for causal language models, `AutoModelForMaskedLM` for masked language models and `AutoModelForSeq2SeqLM` for encoder-decoder models.\n","  FutureWarning,\n"],"name":"stderr"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"208611bb900c42379cec876edad66609","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=467042463.0, style=ProgressStyle(descri…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"oWEInNuCgseW"},"source":["from transformers import AdamW\n","param_optimizer = list(XLmodel.named_parameters())\n","no_decay = ['bias', 'gamma', 'beta']\n","optimizer_grouped_parameters = [\n","    {'params': [p for n, p in param_optimizer if not any(nd in n for nd in no_decay)],\n","     'weight_decay_rate': 0.01},\n","    {'params': [p for n, p in param_optimizer if any(nd in n for nd in no_decay)],\n","     'weight_decay_rate': 0.0}\n","]\n","# This variable contains all of the hyperparemeter information our training loop needs\n","optimizer = AdamW(optimizer_grouped_parameters,\n","                     lr=2e-5)"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"1k83JwsafsPf","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1615188437468,"user_tz":480,"elapsed":2077634,"user":{"displayName":"sm P","photoUrl":"","userId":"09365976717144143194"}},"outputId":"b5086d91-d39d-4c48-b1f3-2eb8b31ea4e0"},"source":["# Store our loss and accuracy for plotting\n","train_loss_set = []\n","\n","# Number of training epochs (authors recommend between 2 and 4)\n","epochs = 4\n","\n","# trange is a tqdm wrapper around the normal python range\n","for _ in trange(epochs, desc=\"Epoch\"):\n","  # Training\n","  # Set our XLmodel to training mode (as opposed to evaluation mode)\n","  XLmodel.train()\n","  XLmodel = XLmodel.to(device)\n","  # Tracking variables\n","  tr_loss = 0\n","  nb_tr_examples, nb_tr_steps = 0, 0\n","  \n","  # Train the data for one epoch\n","  for step, batch in enumerate(train_dataloader):\n","    print(\"Step: %s\"%(step))\n","    # Add batch to GPU\n","    batch = tuple(t.to(device) for t in batch)\n","    # Unpack the inputs from our dataloader\n","    b_input_ids, b_input_mask = batch\n","    # Clear out the gradients (by default they accumulate)\n","    optimizer.zero_grad()\n","    # Forward pass\n","    # outputs = XLmodel(**inputs, labels=inputs[\"input_ids\"])\n","    outputs = XLmodel(input_ids=b_input_ids, labels=b_input_ids, token_type_ids=None, attention_mask=b_input_mask)\n","    #print(outputs)\n","    loss = outputs.loss\n","    logits = outputs.logits\n","    if(loss is not None):\n","      train_loss_set.append(loss.item())  \n","      # Backward pass\n","      loss.backward()\n","    # Update parameters and take a step using the computed gradient\n","    optimizer.step()\n","    \n","    \n","    # Update tracking variables\n","    if(loss is not None):\n","      tr_loss += loss.item()\n","    nb_tr_examples += b_input_ids.size(0)\n","    nb_tr_steps += 1\n","\n","  print(\"Train loss: {}\".format(tr_loss/nb_tr_steps))"],"execution_count":null,"outputs":[{"output_type":"stream","text":["\rEpoch:   0%|          | 0/4 [00:00<?, ?it/s]"],"name":"stderr"},{"output_type":"stream","text":["Step: 0\n","Step: 1\n","Step: 2\n","Step: 3\n","Step: 4\n","Step: 5\n","Step: 6\n","Step: 7\n","Step: 8\n","Step: 9\n","Step: 10\n","Step: 11\n","Step: 12\n","Step: 13\n","Step: 14\n","Step: 15\n","Step: 16\n","Step: 17\n","Step: 18\n","Step: 19\n","Step: 20\n","Step: 21\n","Step: 22\n","Step: 23\n","Step: 24\n","Step: 25\n","Step: 26\n","Step: 27\n","Step: 28\n","Step: 29\n","Step: 30\n","Step: 31\n","Step: 32\n","Step: 33\n","Step: 34\n","Step: 35\n","Step: 36\n","Step: 37\n","Step: 38\n","Step: 39\n","Step: 40\n","Step: 41\n","Step: 42\n","Step: 43\n","Step: 44\n","Step: 45\n","Step: 46\n","Step: 47\n","Step: 48\n","Step: 49\n","Step: 50\n","Step: 51\n","Step: 52\n","Step: 53\n","Step: 54\n","Step: 55\n","Step: 56\n","Step: 57\n","Step: 58\n","Step: 59\n","Step: 60\n","Step: 61\n","Step: 62\n","Step: 63\n","Step: 64\n","Step: 65\n","Step: 66\n","Step: 67\n","Step: 68\n","Step: 69\n","Step: 70\n","Step: 71\n","Step: 72\n","Step: 73\n","Step: 74\n","Step: 75\n","Step: 76\n","Step: 77\n","Step: 78\n","Step: 79\n","Step: 80\n","Step: 81\n","Step: 82\n","Step: 83\n","Step: 84\n","Step: 85\n","Step: 86\n","Step: 87\n","Step: 88\n","Step: 89\n","Step: 90\n","Step: 91\n","Step: 92\n","Step: 93\n","Step: 94\n","Step: 95\n","Step: 96\n","Step: 97\n","Step: 98\n","Step: 99\n","Step: 100\n","Step: 101\n","Step: 102\n","Step: 103\n","Step: 104\n","Step: 105\n","Step: 106\n","Step: 107\n","Step: 108\n","Step: 109\n","Step: 110\n","Step: 111\n","Step: 112\n","Step: 113\n","Step: 114\n","Step: 115\n","Step: 116\n","Step: 117\n","Step: 118\n","Step: 119\n","Step: 120\n","Step: 121\n","Step: 122\n","Step: 123\n","Step: 124\n","Step: 125\n","Step: 126\n","Step: 127\n","Step: 128\n","Step: 129\n","Step: 130\n","Step: 131\n","Step: 132\n","Step: 133\n","Step: 134\n","Step: 135\n","Step: 136\n","Step: 137\n","Step: 138\n","Step: 139\n","Step: 140\n","Step: 141\n","Step: 142\n","Step: 143\n","Step: 144\n","Step: 145\n","Step: 146\n","Step: 147\n","Step: 148\n","Step: 149\n","Step: 150\n","Step: 151\n","Step: 152\n","Step: 153\n","Step: 154\n","Step: 155\n","Step: 156\n","Step: 157\n","Step: 158\n","Step: 159\n","Step: 160\n","Step: 161\n","Step: 162\n","Step: 163\n","Step: 164\n","Step: 165\n","Step: 166\n","Step: 167\n","Step: 168\n","Step: 169\n","Step: 170\n","Step: 171\n","Step: 172\n","Step: 173\n","Step: 174\n","Step: 175\n","Step: 176\n","Step: 177\n","Step: 178\n","Step: 179\n","Step: 180\n","Step: 181\n","Step: 182\n","Step: 183\n","Step: 184\n","Step: 185\n","Step: 186\n","Step: 187\n","Step: 188\n","Step: 189\n","Step: 190\n","Step: 191\n","Step: 192\n","Step: 193\n","Step: 194\n","Step: 195\n","Step: 196\n","Step: 197\n","Step: 198\n","Step: 199\n","Step: 200\n","Step: 201\n","Step: 202\n","Step: 203\n","Step: 204\n","Step: 205\n","Step: 206\n","Step: 207\n","Step: 208\n","Step: 209\n","Step: 210\n","Step: 211\n","Step: 212\n","Step: 213\n","Step: 214\n","Step: 215\n","Step: 216\n","Step: 217\n","Step: 218\n","Step: 219\n","Step: 220\n","Step: 221\n","Step: 222\n","Step: 223\n","Step: 224\n","Step: 225\n","Step: 226\n","Step: 227\n","Step: 228\n","Step: 229\n","Step: 230\n","Step: 231\n","Step: 232\n","Step: 233\n","Step: 234\n","Step: 235\n","Step: 236\n","Step: 237\n","Step: 238\n","Step: 239\n","Step: 240\n","Step: 241\n","Step: 242\n","Step: 243\n","Step: 244\n","Step: 245\n","Step: 246\n","Step: 247\n","Step: 248\n","Step: 249\n","Step: 250\n","Step: 251\n","Step: 252\n","Step: 253\n","Step: 254\n","Step: 255\n","Step: 256\n","Step: 257\n","Step: 258\n","Step: 259\n","Step: 260\n","Step: 261\n","Step: 262\n","Step: 263\n","Step: 264\n","Step: 265\n","Step: 266\n","Step: 267\n","Step: 268\n","Step: 269\n","Step: 270\n","Step: 271\n","Step: 272\n","Step: 273\n","Step: 274\n","Step: 275\n","Step: 276\n","Step: 277\n","Step: 278\n","Step: 279\n","Step: 280\n","Step: 281\n","Step: 282\n","Step: 283\n","Step: 284\n","Step: 285\n","Step: 286\n","Step: 287\n","Step: 288\n","Step: 289\n","Step: 290\n","Step: 291\n","Step: 292\n","Step: 293\n","Step: 294\n","Step: 295\n","Step: 296\n","Step: 297\n","Step: 298\n","Step: 299\n","Step: 300\n","Step: 301\n","Step: 302\n","Step: 303\n","Step: 304\n","Step: 305\n","Step: 306\n","Step: 307\n","Step: 308\n","Step: 309\n","Step: 310\n","Step: 311\n"],"name":"stdout"},{"output_type":"stream","text":["\rEpoch:  25%|██▌       | 1/4 [01:27<04:23, 87.90s/it]"],"name":"stderr"},{"output_type":"stream","text":["Step: 312\n","Train loss: 0.04053902502964658\n","Step: 0\n","Step: 1\n","Step: 2\n","Step: 3\n","Step: 4\n","Step: 5\n","Step: 6\n","Step: 7\n","Step: 8\n","Step: 9\n","Step: 10\n","Step: 11\n","Step: 12\n","Step: 13\n","Step: 14\n","Step: 15\n","Step: 16\n","Step: 17\n","Step: 18\n","Step: 19\n","Step: 20\n","Step: 21\n","Step: 22\n","Step: 23\n","Step: 24\n","Step: 25\n","Step: 26\n","Step: 27\n","Step: 28\n","Step: 29\n","Step: 30\n","Step: 31\n","Step: 32\n","Step: 33\n","Step: 34\n","Step: 35\n","Step: 36\n","Step: 37\n","Step: 38\n","Step: 39\n","Step: 40\n","Step: 41\n","Step: 42\n","Step: 43\n","Step: 44\n","Step: 45\n","Step: 46\n","Step: 47\n","Step: 48\n","Step: 49\n","Step: 50\n","Step: 51\n","Step: 52\n","Step: 53\n","Step: 54\n","Step: 55\n","Step: 56\n","Step: 57\n","Step: 58\n","Step: 59\n","Step: 60\n","Step: 61\n","Step: 62\n","Step: 63\n","Step: 64\n","Step: 65\n","Step: 66\n","Step: 67\n","Step: 68\n","Step: 69\n","Step: 70\n","Step: 71\n","Step: 72\n","Step: 73\n","Step: 74\n","Step: 75\n","Step: 76\n","Step: 77\n","Step: 78\n","Step: 79\n","Step: 80\n","Step: 81\n","Step: 82\n","Step: 83\n","Step: 84\n","Step: 85\n","Step: 86\n","Step: 87\n","Step: 88\n","Step: 89\n","Step: 90\n","Step: 91\n","Step: 92\n","Step: 93\n","Step: 94\n","Step: 95\n","Step: 96\n","Step: 97\n","Step: 98\n","Step: 99\n","Step: 100\n","Step: 101\n","Step: 102\n","Step: 103\n","Step: 104\n","Step: 105\n","Step: 106\n","Step: 107\n","Step: 108\n","Step: 109\n","Step: 110\n","Step: 111\n","Step: 112\n","Step: 113\n","Step: 114\n","Step: 115\n","Step: 116\n","Step: 117\n","Step: 118\n","Step: 119\n","Step: 120\n","Step: 121\n","Step: 122\n","Step: 123\n","Step: 124\n","Step: 125\n","Step: 126\n","Step: 127\n","Step: 128\n","Step: 129\n","Step: 130\n","Step: 131\n","Step: 132\n","Step: 133\n","Step: 134\n","Step: 135\n","Step: 136\n","Step: 137\n","Step: 138\n","Step: 139\n","Step: 140\n","Step: 141\n","Step: 142\n","Step: 143\n","Step: 144\n","Step: 145\n","Step: 146\n","Step: 147\n","Step: 148\n","Step: 149\n","Step: 150\n","Step: 151\n","Step: 152\n","Step: 153\n","Step: 154\n","Step: 155\n","Step: 156\n","Step: 157\n","Step: 158\n","Step: 159\n","Step: 160\n","Step: 161\n","Step: 162\n","Step: 163\n","Step: 164\n","Step: 165\n","Step: 166\n","Step: 167\n","Step: 168\n","Step: 169\n","Step: 170\n","Step: 171\n","Step: 172\n","Step: 173\n","Step: 174\n","Step: 175\n","Step: 176\n","Step: 177\n","Step: 178\n","Step: 179\n","Step: 180\n","Step: 181\n","Step: 182\n","Step: 183\n","Step: 184\n","Step: 185\n","Step: 186\n","Step: 187\n","Step: 188\n","Step: 189\n","Step: 190\n","Step: 191\n","Step: 192\n","Step: 193\n","Step: 194\n","Step: 195\n","Step: 196\n","Step: 197\n","Step: 198\n","Step: 199\n","Step: 200\n","Step: 201\n","Step: 202\n","Step: 203\n","Step: 204\n","Step: 205\n","Step: 206\n","Step: 207\n","Step: 208\n","Step: 209\n","Step: 210\n","Step: 211\n","Step: 212\n","Step: 213\n","Step: 214\n","Step: 215\n","Step: 216\n","Step: 217\n","Step: 218\n","Step: 219\n","Step: 220\n","Step: 221\n","Step: 222\n","Step: 223\n","Step: 224\n","Step: 225\n","Step: 226\n","Step: 227\n","Step: 228\n","Step: 229\n","Step: 230\n","Step: 231\n","Step: 232\n","Step: 233\n","Step: 234\n","Step: 235\n","Step: 236\n","Step: 237\n","Step: 238\n","Step: 239\n","Step: 240\n","Step: 241\n","Step: 242\n","Step: 243\n","Step: 244\n","Step: 245\n","Step: 246\n","Step: 247\n","Step: 248\n","Step: 249\n","Step: 250\n","Step: 251\n","Step: 252\n","Step: 253\n","Step: 254\n","Step: 255\n","Step: 256\n","Step: 257\n","Step: 258\n","Step: 259\n","Step: 260\n","Step: 261\n","Step: 262\n","Step: 263\n","Step: 264\n","Step: 265\n","Step: 266\n","Step: 267\n","Step: 268\n","Step: 269\n","Step: 270\n","Step: 271\n","Step: 272\n","Step: 273\n","Step: 274\n","Step: 275\n","Step: 276\n","Step: 277\n","Step: 278\n","Step: 279\n","Step: 280\n","Step: 281\n","Step: 282\n","Step: 283\n","Step: 284\n","Step: 285\n","Step: 286\n","Step: 287\n","Step: 288\n","Step: 289\n","Step: 290\n","Step: 291\n","Step: 292\n","Step: 293\n","Step: 294\n","Step: 295\n","Step: 296\n","Step: 297\n","Step: 298\n","Step: 299\n","Step: 300\n","Step: 301\n","Step: 302\n","Step: 303\n","Step: 304\n","Step: 305\n","Step: 306\n","Step: 307\n","Step: 308\n","Step: 309\n","Step: 310\n","Step: 311\n"],"name":"stdout"},{"output_type":"stream","text":["\rEpoch:  50%|█████     | 2/4 [02:55<02:55, 87.81s/it]"],"name":"stderr"},{"output_type":"stream","text":["Step: 312\n","Train loss: 0.002567103243906783\n","Step: 0\n","Step: 1\n","Step: 2\n","Step: 3\n","Step: 4\n","Step: 5\n","Step: 6\n","Step: 7\n","Step: 8\n","Step: 9\n","Step: 10\n","Step: 11\n","Step: 12\n","Step: 13\n","Step: 14\n","Step: 15\n","Step: 16\n","Step: 17\n","Step: 18\n","Step: 19\n","Step: 20\n","Step: 21\n","Step: 22\n","Step: 23\n","Step: 24\n","Step: 25\n","Step: 26\n","Step: 27\n","Step: 28\n","Step: 29\n","Step: 30\n","Step: 31\n","Step: 32\n","Step: 33\n","Step: 34\n","Step: 35\n","Step: 36\n","Step: 37\n","Step: 38\n","Step: 39\n","Step: 40\n","Step: 41\n","Step: 42\n","Step: 43\n","Step: 44\n","Step: 45\n","Step: 46\n","Step: 47\n","Step: 48\n","Step: 49\n","Step: 50\n","Step: 51\n","Step: 52\n","Step: 53\n","Step: 54\n","Step: 55\n","Step: 56\n","Step: 57\n","Step: 58\n","Step: 59\n","Step: 60\n","Step: 61\n","Step: 62\n","Step: 63\n","Step: 64\n","Step: 65\n","Step: 66\n","Step: 67\n","Step: 68\n","Step: 69\n","Step: 70\n","Step: 71\n","Step: 72\n","Step: 73\n","Step: 74\n","Step: 75\n","Step: 76\n","Step: 77\n","Step: 78\n","Step: 79\n","Step: 80\n","Step: 81\n","Step: 82\n","Step: 83\n","Step: 84\n","Step: 85\n","Step: 86\n","Step: 87\n","Step: 88\n","Step: 89\n","Step: 90\n","Step: 91\n","Step: 92\n","Step: 93\n","Step: 94\n","Step: 95\n","Step: 96\n","Step: 97\n","Step: 98\n","Step: 99\n","Step: 100\n","Step: 101\n","Step: 102\n","Step: 103\n","Step: 104\n","Step: 105\n","Step: 106\n","Step: 107\n","Step: 108\n","Step: 109\n","Step: 110\n","Step: 111\n","Step: 112\n","Step: 113\n","Step: 114\n","Step: 115\n","Step: 116\n","Step: 117\n","Step: 118\n","Step: 119\n","Step: 120\n","Step: 121\n","Step: 122\n","Step: 123\n","Step: 124\n","Step: 125\n","Step: 126\n","Step: 127\n","Step: 128\n","Step: 129\n","Step: 130\n","Step: 131\n","Step: 132\n","Step: 133\n","Step: 134\n","Step: 135\n","Step: 136\n","Step: 137\n","Step: 138\n","Step: 139\n","Step: 140\n","Step: 141\n","Step: 142\n","Step: 143\n","Step: 144\n","Step: 145\n","Step: 146\n","Step: 147\n","Step: 148\n","Step: 149\n","Step: 150\n","Step: 151\n","Step: 152\n","Step: 153\n","Step: 154\n","Step: 155\n","Step: 156\n","Step: 157\n","Step: 158\n","Step: 159\n","Step: 160\n","Step: 161\n","Step: 162\n","Step: 163\n","Step: 164\n","Step: 165\n","Step: 166\n","Step: 167\n","Step: 168\n","Step: 169\n","Step: 170\n","Step: 171\n","Step: 172\n","Step: 173\n","Step: 174\n","Step: 175\n","Step: 176\n","Step: 177\n","Step: 178\n","Step: 179\n","Step: 180\n","Step: 181\n","Step: 182\n","Step: 183\n","Step: 184\n","Step: 185\n","Step: 186\n","Step: 187\n","Step: 188\n","Step: 189\n","Step: 190\n","Step: 191\n","Step: 192\n","Step: 193\n","Step: 194\n","Step: 195\n","Step: 196\n","Step: 197\n","Step: 198\n","Step: 199\n","Step: 200\n","Step: 201\n","Step: 202\n","Step: 203\n","Step: 204\n","Step: 205\n","Step: 206\n","Step: 207\n","Step: 208\n","Step: 209\n","Step: 210\n","Step: 211\n","Step: 212\n","Step: 213\n","Step: 214\n","Step: 215\n","Step: 216\n","Step: 217\n","Step: 218\n","Step: 219\n","Step: 220\n","Step: 221\n","Step: 222\n","Step: 223\n","Step: 224\n","Step: 225\n","Step: 226\n","Step: 227\n","Step: 228\n","Step: 229\n","Step: 230\n","Step: 231\n","Step: 232\n","Step: 233\n","Step: 234\n","Step: 235\n","Step: 236\n","Step: 237\n","Step: 238\n","Step: 239\n","Step: 240\n","Step: 241\n","Step: 242\n","Step: 243\n","Step: 244\n","Step: 245\n","Step: 246\n","Step: 247\n","Step: 248\n","Step: 249\n","Step: 250\n","Step: 251\n","Step: 252\n","Step: 253\n","Step: 254\n","Step: 255\n","Step: 256\n","Step: 257\n","Step: 258\n","Step: 259\n","Step: 260\n","Step: 261\n","Step: 262\n","Step: 263\n","Step: 264\n","Step: 265\n","Step: 266\n","Step: 267\n","Step: 268\n","Step: 269\n","Step: 270\n","Step: 271\n","Step: 272\n","Step: 273\n","Step: 274\n","Step: 275\n","Step: 276\n","Step: 277\n","Step: 278\n","Step: 279\n","Step: 280\n","Step: 281\n","Step: 282\n","Step: 283\n","Step: 284\n","Step: 285\n","Step: 286\n","Step: 287\n","Step: 288\n","Step: 289\n","Step: 290\n","Step: 291\n","Step: 292\n","Step: 293\n","Step: 294\n","Step: 295\n","Step: 296\n","Step: 297\n","Step: 298\n","Step: 299\n","Step: 300\n","Step: 301\n","Step: 302\n","Step: 303\n","Step: 304\n","Step: 305\n","Step: 306\n","Step: 307\n","Step: 308\n","Step: 309\n","Step: 310\n","Step: 311\n"],"name":"stdout"},{"output_type":"stream","text":["\rEpoch:  75%|███████▌  | 3/4 [04:23<01:27, 87.75s/it]"],"name":"stderr"},{"output_type":"stream","text":["Step: 312\n","Train loss: 0.0011633808530060747\n","Step: 0\n","Step: 1\n","Step: 2\n","Step: 3\n","Step: 4\n","Step: 5\n","Step: 6\n","Step: 7\n","Step: 8\n","Step: 9\n","Step: 10\n","Step: 11\n","Step: 12\n","Step: 13\n","Step: 14\n","Step: 15\n","Step: 16\n","Step: 17\n","Step: 18\n","Step: 19\n","Step: 20\n","Step: 21\n","Step: 22\n","Step: 23\n","Step: 24\n","Step: 25\n","Step: 26\n","Step: 27\n","Step: 28\n","Step: 29\n","Step: 30\n","Step: 31\n","Step: 32\n","Step: 33\n","Step: 34\n","Step: 35\n","Step: 36\n","Step: 37\n","Step: 38\n","Step: 39\n","Step: 40\n","Step: 41\n","Step: 42\n","Step: 43\n","Step: 44\n","Step: 45\n","Step: 46\n","Step: 47\n","Step: 48\n","Step: 49\n","Step: 50\n","Step: 51\n","Step: 52\n","Step: 53\n","Step: 54\n","Step: 55\n","Step: 56\n","Step: 57\n","Step: 58\n","Step: 59\n","Step: 60\n","Step: 61\n","Step: 62\n","Step: 63\n","Step: 64\n","Step: 65\n","Step: 66\n","Step: 67\n","Step: 68\n","Step: 69\n","Step: 70\n","Step: 71\n","Step: 72\n","Step: 73\n","Step: 74\n","Step: 75\n","Step: 76\n","Step: 77\n","Step: 78\n","Step: 79\n","Step: 80\n","Step: 81\n","Step: 82\n","Step: 83\n","Step: 84\n","Step: 85\n","Step: 86\n","Step: 87\n","Step: 88\n","Step: 89\n","Step: 90\n","Step: 91\n","Step: 92\n","Step: 93\n","Step: 94\n","Step: 95\n","Step: 96\n","Step: 97\n","Step: 98\n","Step: 99\n","Step: 100\n","Step: 101\n","Step: 102\n","Step: 103\n","Step: 104\n","Step: 105\n","Step: 106\n","Step: 107\n","Step: 108\n","Step: 109\n","Step: 110\n","Step: 111\n","Step: 112\n","Step: 113\n","Step: 114\n","Step: 115\n","Step: 116\n","Step: 117\n","Step: 118\n","Step: 119\n","Step: 120\n","Step: 121\n","Step: 122\n","Step: 123\n","Step: 124\n","Step: 125\n","Step: 126\n","Step: 127\n","Step: 128\n","Step: 129\n","Step: 130\n","Step: 131\n","Step: 132\n","Step: 133\n","Step: 134\n","Step: 135\n","Step: 136\n","Step: 137\n","Step: 138\n","Step: 139\n","Step: 140\n","Step: 141\n","Step: 142\n","Step: 143\n","Step: 144\n","Step: 145\n","Step: 146\n","Step: 147\n","Step: 148\n","Step: 149\n","Step: 150\n","Step: 151\n","Step: 152\n","Step: 153\n","Step: 154\n","Step: 155\n","Step: 156\n","Step: 157\n","Step: 158\n","Step: 159\n","Step: 160\n","Step: 161\n","Step: 162\n","Step: 163\n","Step: 164\n","Step: 165\n","Step: 166\n","Step: 167\n","Step: 168\n","Step: 169\n","Step: 170\n","Step: 171\n","Step: 172\n","Step: 173\n","Step: 174\n","Step: 175\n","Step: 176\n","Step: 177\n","Step: 178\n","Step: 179\n","Step: 180\n","Step: 181\n","Step: 182\n","Step: 183\n","Step: 184\n","Step: 185\n","Step: 186\n","Step: 187\n","Step: 188\n","Step: 189\n","Step: 190\n","Step: 191\n","Step: 192\n","Step: 193\n","Step: 194\n","Step: 195\n","Step: 196\n","Step: 197\n","Step: 198\n","Step: 199\n","Step: 200\n","Step: 201\n","Step: 202\n","Step: 203\n","Step: 204\n","Step: 205\n","Step: 206\n","Step: 207\n","Step: 208\n","Step: 209\n","Step: 210\n","Step: 211\n","Step: 212\n","Step: 213\n","Step: 214\n","Step: 215\n","Step: 216\n","Step: 217\n","Step: 218\n","Step: 219\n","Step: 220\n","Step: 221\n","Step: 222\n","Step: 223\n","Step: 224\n","Step: 225\n","Step: 226\n","Step: 227\n","Step: 228\n","Step: 229\n","Step: 230\n","Step: 231\n","Step: 232\n","Step: 233\n","Step: 234\n","Step: 235\n","Step: 236\n","Step: 237\n","Step: 238\n","Step: 239\n","Step: 240\n","Step: 241\n","Step: 242\n","Step: 243\n","Step: 244\n","Step: 245\n","Step: 246\n","Step: 247\n","Step: 248\n","Step: 249\n","Step: 250\n","Step: 251\n","Step: 252\n","Step: 253\n","Step: 254\n","Step: 255\n","Step: 256\n","Step: 257\n","Step: 258\n","Step: 259\n","Step: 260\n","Step: 261\n","Step: 262\n","Step: 263\n","Step: 264\n","Step: 265\n","Step: 266\n","Step: 267\n","Step: 268\n","Step: 269\n","Step: 270\n","Step: 271\n","Step: 272\n","Step: 273\n","Step: 274\n","Step: 275\n","Step: 276\n","Step: 277\n","Step: 278\n","Step: 279\n","Step: 280\n","Step: 281\n","Step: 282\n","Step: 283\n","Step: 284\n","Step: 285\n","Step: 286\n","Step: 287\n","Step: 288\n","Step: 289\n","Step: 290\n","Step: 291\n","Step: 292\n","Step: 293\n","Step: 294\n","Step: 295\n","Step: 296\n","Step: 297\n","Step: 298\n","Step: 299\n","Step: 300\n","Step: 301\n","Step: 302\n","Step: 303\n","Step: 304\n","Step: 305\n","Step: 306\n","Step: 307\n","Step: 308\n","Step: 309\n","Step: 310\n","Step: 311\n"],"name":"stdout"},{"output_type":"stream","text":["Epoch: 100%|██████████| 4/4 [05:50<00:00, 87.66s/it]"],"name":"stderr"},{"output_type":"stream","text":["Step: 312\n","Train loss: 0.0007068549186424962\n"],"name":"stdout"},{"output_type":"stream","text":["\n"],"name":"stderr"}]},{"cell_type":"markdown","metadata":{"id":"GH8wnn_w_1ZU"},"source":["# Rhyming Part"]},{"cell_type":"code","metadata":{"id":"05TbQNLQhfbr"},"source":["\r\n","import pandas as pd\r\n","\r\n","STRESSES = {'AA1', 'AE1', 'AH1', 'AO1', 'AW1', 'AY1', 'EH1', 'ER1', 'EY1', 'IH1', 'IY1', 'OW1', 'OY1', 'UH1', 'UW1'}\r\n","\"\"\"\r\n","def fileToDict(filepath):\r\n","    dictA = dict()\r\n","    with open(filepath) as fileA:\r\n","        for line in fileA:\r\n","            words = line.split() \r\n","            dictA[words[0]] = tuple(words[1:])\r\n","    return dictA\r\n","\r\n","PDICT = fileToDict(\"CMUdict.txt\") \r\n","print(len(PDICT.keys()))\r\n","\r\n","import nltk \r\n","nltk.download('words')\r\n","nltk.download('punkt')\r\n","file_content = open(\"fusion.txt\").read()\r\n","tokens = nltk.word_tokenize(file_content)\r\n","\r\n","def cleanDict (pDict):\r\n","  phodict = {} \r\n","  for i in pDict.keys():\r\n","     if ((i.lower() in tokens) and (i.isalpha())):\r\n","       phodict[i] = pDict[i]\r\n","  return phodict\r\n","PHODICT = cleanDict (PDICT)\r\n","print(len(PHODICT.keys()))\r\n","\"\"\"\r\n","import ast\r\n","file = open(\"dict.txt\", \"r\")\r\n","\r\n","contents = file.read()\r\n","PHODICT = ast.literal_eval(contents)\r\n","\r\n","file.close()\r\n","\r\n","def isSubList(listA, listB):\r\n","    if len(listA) < len(listB):\r\n","        return isSubList(listB, listA)\r\n","    n = len(listB)\r\n","    for start in range(len(listA)-n+1):\r\n","        if all(listA[start+i] == listB[i] for i in range(n)):\r\n","            return True\r\n","    return False\r\n","\r\n","def getRhymes(word):\r\n","    print(type(word))\r\n","    sounds = PHODICT[word]\r\n","    for index,sound in enumerate(reversed(sounds)):\r\n","        if sound in STRESSES:\r\n","            ending = sounds[-index-1:]\r\n","            break\r\n","    yielded = set()\r\n","    for wordB, soundsB in PHODICT.items():\r\n","        if (ending == soundsB[-index-1:]) and (soundsB not in yielded) and (not isSubList(sounds, soundsB)):\r\n","            yielded.add(soundsB)\r\n","            yield wordB\r\n","\r\n"],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"PGmw9NiEP-5t"},"source":["#Generation Part"]},{"cell_type":"code","metadata":{"id":"kifyJ4H6m3KM"},"source":["def rhymeFinder(inWord):\r\n","  lastWord = inWord\r\n","  sameRhyme = []\r\n","  for word in getRhymes(lastWord.upper()):\r\n","    sameRhyme.append(word.lower())\r\n","  outWord = random.choice(sameRhyme)\r\n","  return outWord\r\n","\r\n","def reverseSentence(inList):\r\n","  words = inList[0].split()\r\n","  outStr = ' '.join(reversed(words))\r\n","  return outStr\r\n","\r\n","def reverseW(line):\r\n","  words = line.split()\r\n","  reversed_words = ' '.join(reversed(words))\r\n","  return reversed_words\r\n","\r\n","PADDING_TEXT = \"\"\"They tryna be cray \r\n","They tryna be cray \r\n","She wanna meet Carti \r\n","That bitch is a Barbie \r\n","I'ma fuck these hoes \r\n","I'm on 730\r\n","Got a brand new pack like Kid Cudi\r\n","I smoke dope like Kid Cudi\r\n","Push up and get the slugs from me \r\n","I'm with all the shits \r\n","She wanna meet Carti  \r\n","\"\"\"\r\n","END = \"\"\"<eod> </s> <eos>\"\"\"\r\n","\r\n","TEXT_PD = reverseW(PADDING_TEXT) + reverseW(END)\r\n"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"OYC2VmEKJr0W","scrolled":true,"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1615188466067,"user_tz":480,"elapsed":2377,"user":{"displayName":"sm P","photoUrl":"","userId":"09365976717144143194"}},"outputId":"d3996a29-d57e-4f5b-d877-66256cd5f3d1"},"source":["firstSeed = \"Good day\"\n","\n","BART_sentence = generate_lyrics(seed_line = firstSeed, num_lines = 2, model_ = model, startW = 'You',\n","                           noise_percent = 0.25, multiple_lines = False, max_line_history = 1)\n","\n","startword = rhymeFinder(BART_sentence[-1].split()[-1])\n","\n","prompt = \" \" + startword\n","tpmorp = reverseW(prompt)\n","\n","XLinputs = XLtokenizer.encode(PADDING_TEXT + prompt, add_special_tokens=False, return_tensors=\"pt\")\n","\n","XLinputs = XLinputs.to(device)\n","\n","prompt_length = len(XLtokenizer.decode(XLinputs[0], skip_special_tokens=True, clean_up_tokenization_spaces=True))\n","outputs = XLmodel.generate(XLinputs, max_length=100, do_sample=True, top_p=0.99, top_k=25)\n","\n","generated = XLtokenizer.decode(outputs[0])[prompt_length:] + prompt\n","print(generated)"],"execution_count":null,"outputs":[{"output_type":"stream","text":["Good day\n","You I don't give a fuck what you think\n","<class 'str'>\n",". they tryna be na do the plas and plas and cray they brink\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"rwvQWG7FWa_Y"},"source":[""],"execution_count":null,"outputs":[]}]}